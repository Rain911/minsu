<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <title>房屋编辑</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- Bootstrap 3.3.5 -->
    <link rel="stylesheet" href="__PUBLIC__/Admin/bootstrap/css/bootstrap.min.css">
    <!-- Font Awesome -->
<link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/Font-Awesome-master/css/font-awesome.min.css"/>
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/ionicons-master/css/ionicons.min.css"/>
    <!-- DataTables -->
    <link rel="stylesheet" href="__PUBLIC__/Admin/plugins/datatables/dataTables.bootstrap.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="__PUBLIC__/Admin/dist/css/AdminLTE.min.css">
    <link rel="stylesheet" href="__PUBLIC__/Admin/dist/css/skins/_all-skins.min.css">
  </head>
  <body class="skin-blue sidebar-mini sidebar-collapse">

    <div class="wrapper">
    <header class="main-header">

      <!-- Logo -->

      <a href="{:U('Index/index')}" class="logo">

        <!-- mini logo for sidebar mini 50x50 pixels -->

        <span class="logo-mini"><b>房屋</b></span>

        <!-- logo for regular state and mobile devices -->

        <span class="logo-lg"><b>房屋</b></span>

      </a>

      <!-- Header Navbar: style can be found in header.less -->

      <nav class="navbar navbar-static-top" role="navigation">

        <!-- Sidebar toggle button-->

        <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">

          <span class="sr-only">Toggle navigation</span>

        </a>

        <div class="navbar-custom-menu">

          <ul class="nav navbar-nav">

            <!-- Messages: style can be found in dropdown.less-->

            <!-- User Account: style can be found in dropdown.less -->

            <li class="dropdown user user-menu">

              <a href="#" class="dropdown-toggle" data-toggle="dropdown">

                <img src="__PUBLIC__/Admin/dist/img/user2-160x160.jpg" class="user-image" alt="User Image">

                <span class="hidden-xs">{$_SESSION['aname']}</span>

              </a>

              <ul class="dropdown-menu">

                <!-- User image -->

                <li class="user-header">

                  <img src="__PUBLIC__/Admin/dist/img/user2-160x160.jpg" class="img-circle" alt="User Image">

                  <p>

                    <small>管理员</small>

                  </p>

                </li>

                <li class="user-footer">

                  <div class="pull-right">

                    <a href="{:U('Login/out')}" class="btn btn-default btn-flat">安全退出</a>

                  </div>

                </li>

              </ul>

            </li>

          </ul>

        </div>

      </nav>

    </header>

    <!-- Left side column. contains the logo and sidebar -->

    <aside class="main-sidebar">

      <!-- sidebar: style can be found in sidebar.less -->

      <section class="sidebar">

        <!-- Sidebar user panel -->

        <div class="user-panel">

          <div class="pull-left image">

            <img src="__PUBLIC__/Admin/dist/img/user2-160x160.jpg" class="img-circle" alt="User Image">

          </div>

          <div class="pull-left info">

            <p>{$_SESSION['aname']}</p>

            <a href="#"><i class="fa fa-circle text-success"></i> Online</a>

          </div>

        </div>

        <!-- search form -->

        <form action="#" method="get" class="sidebar-form">

          <div class="input-group">

            <input type="text" name="q" class="form-control" placeholder="Search...">

            <span class="input-group-btn">
                        <button type="submit" name="search" id="search-btn" class="btn btn-flat"><i class="fa fa-search"></i></button>
                      </span>

          </div>

        </form>

        <!-- /.search form -->

        <!-- sidebar menu: : style can be found in sidebar.less -->

        <ul class="sidebar-menu">

          <!--<li class="header">MAIN NAVIGATION</li>-->

          <li class="active treeview">

            <a href="{:U('Fmss/index')}">

              <i class="fa fa-dashboard"></i> <span>首页</span> <i class="fa fa-angle-left pull-right"></i>

            </a>

          </li>

          <!--菜单栏循环开始-->

          <foreach name="auth_infoA" item="v">

            <li class="treeview">

              <a href="#">

                <i class="fa {$v.auth_icon}"></i>

                <span>{$v.auth_name}</span>

              </a>

              <ul class="treeview-menu">



                <foreach name="auth_infoB" item="vv">

                  <if condition="$vv['auth_pid'] eq $v['auth_id']">

                    <li><a href="__MODULE__/{$vv.auth_c}/{$vv.auth_a}"><i class="fa fa-circle-o"></i>{$vv.auth_name}</a></li>

                  </if>

                </foreach>



              </ul>

            </li>

          </foreach>

          <!--菜单栏循环结束-->

        </ul>

      </section>

      <!-- /.sidebar -->

    </aside>
    <div class="content-wrapper" style="background: #FDF5E1;">
      <section class="content-header">
          <div class="box box-primary">
                <div class="box-header with-border">
                  <h3 class="box-title">房屋信息填写</h3>
                </div><!-- /.box-header -->
                <form action="{:U('House/editHouse')}" method="post" enctype="multipart/form-data">
                 <div style="width:50%;margin-bottom:20px;" class="box-to box-body">
                  <div class="form-group" style="overflow: hidden">
	                  <label style="float:left;">房屋地址<span style="color:red">*</span></label><br><br>
	                  <select style="width:20%;float:left;" data="<?php echo $address['0']?>" name="s_province" class="form-control" id="s_province" ></select>
	                  <select style="width:20%;float:left;" data="<?php echo $address['1']?>" name="s_city" value=""  class="form-control" id="s_city"></select>
	                  <select style="width:20%;float:left;" data="<?php echo $address['2']?>" name="s_county" value="" class="form-control" id="s_county"></select>
	                  <input style="width:40%;float:left;" type="text" name="address" class="form-control" id="exampleInputEmail1" placeholder="详细街道"  oninvalid="setCustomValidity(详细街道)" value="<?php echo $address['3']?>">
	                </div>
                  <div class="form-group">
                    <label for="exampleInputEmail1">房屋名称</label><span style="color:red">*</span>
                    <input type="text" name="name" class="form-control" id="exampleInputEmail1" placeholder="房屋名称"  required="required" value="{$result.name}">
                  </div>
                  <div class="form-group">
                    <label for="exampleInputEmail1">可出租年限</label><span style="color:red">*</span>
                    <input type="text" name="rent_year" class="form-control" id="exampleInputEmail1" placeholder="可出租年限"  required="required" value="{$result.rent_year}">
                  </div>
                  <div class="form-group">
                    <label for="exampleInputEmail1">房屋价格</label><span style="color:red">*</span>
                    <input type="text" name="price" class="form-control" id="exampleInputEmail1" placeholder="999/平米 或者 3000/月 (自带单位)"  required="required" value="{$result.price}">
                  </div>
                  <div class="form-group">
                    <label for="exampleInputEmail1">付款方式</label><span style="color:red">*</span>
                    <input type="text" name="payment" class="form-control" id="exampleInputEmail1" placeholder="付款方式"  required="required" value="{$result.payment}">
                  </div>
                  <div class="form-group">
                    <label for="exampleInputEmail1">总房间数</label>
                    <input type="number" name="house_num" class="form-control" id="exampleInputEmail1" placeholder="房间数量"  value="{$result.house_num}">
                  </div> 
                  <div class="form-group">
                    <label for="exampleInputEmail1">可住人房间</label>
                    <input type="text" name="house_live" class="form-control" id="exampleInputEmail1" placeholder="可住人房间"  value="{$result.house_live}">
                  </div> 
                  <div class="form-group">
                    <label for="exampleInputEmail1">可否改建</label>
                    <input type="text" name="modify" class="form-control" id="exampleInputEmail1" placeholder="可否改建,面积限制?"  value="{$result.modify}">
                  </div> 
                  <div class="form-group">
                    <label for="exampleInputEmail1">房屋面积</label>
                    <input type="text" name="area" class="form-control" id="exampleInputEmail1" placeholder="房屋面积 单位㎡" value="{$result.area}" >
                  </div>
                  <div class="form-group">

                      <label>房屋类型</label>

                      <select name="type" class="form-control" id="product_1">

                          <option value='楼房' <?php if($result['type']=='楼房'):?>selected<?php endif?>>楼房</option>

                          <option value='宅院' <?php if($result['type']=='宅院'):?>selected<?php endif?>>宅院</option>

                          <option value='部分出租' <?php if($result['type']=='部分出租'):?>selected<?php endif?>>部分出租</option>

                          <option value='其它' <?php if($result['type']=='其  它'):?>selected<?php endif?>>其它</option>

                      </select>

                  </div>

                  <div class="form-group">

                    <label for="exampleInputEmail1">房屋水电</label>

                    <input type="text" name="water_elect" class="form-control" id="exampleInputEmail1" placeholder="例：自来水 民用电" value="{$result.water_elect}">

                  </div>



                  <div class="form-group">

                    <label for="exampleInputEmail1">有无可耕土地</label>

                    <input type="text" name="land" class="form-control" id="exampleInputEmail1" placeholder="有无果树 蔬菜 土地种植等" value="{$result.land}">

                  </div>

                  <div class="form-group">

                    <label for="exampleInputEmail1">交通描述</label>

                    <input type="text" name="traffic" class="form-control" id="exampleInputEmail1" placeholder="有无公交 客运汽车 多久到达" value="{$result.traffic}">

                  </div>



                  <div class="form-group">

                    <label for="exampleInputEmail1">页面显示点击数量</label>

                    <input type="text" name="traffic" class="form-control" id="exampleInputEmail1" placeholder="页面显示点击数量" value="{$result.house_click}">

                  </div>





                  <div class="form-group">

                    <label for="exampleInputEmail1">房屋其他详情<span style="color:red">*</label>

                    <script id="editor" style="z-index:-5;" type="text/plain" style="width:1024px;height:500px;" name='details'>{$result.details}</script>


                  </div>

                   <div class="clone" style="overflow:hidden">

                      <div style="width:50%;float:left" class="form-group downinfo">

                        <label for="exampleInputPassword6">新增房屋图片(列表图在用户信息那儿修改)</label>

                        <input type="file" name="pic[]" id="exampleInputPassword1">

                      </div>

                      <p class="form-control additem" style="float:left;width:12%;margin-top:25px;margin-left:10px;cursor: pointer;text-align: center">新增</p>

                  </div>

                  

                  <foreach name='result_img' item='v' key='k'>

                    <div class="clone_edit" style="overflow:hidden">

                        <div style="width:50%;float:left" class="form-group downinfo">

                          <label for="exampleInputPassword6">房屋轮播图片</label>

                          <input class="edit_img" type="file" name="pic[]" id="exampleInputPassword1" >

                          <img class="img_pic" style="margin-top: 10px;" width="150" src="__ROOT__/Uploads/{$v.pic}">

                        </div>

                        <p class="form-control reitem_edit" style="float:left;width:12%;margin-top:25px;margin-left:10px;cursor: pointer;text-align: center">删除</p>

                        <input class="temp_img" type="hidden" name="temp_img[]" value="{$v.pic}">

                    </div>

                  </foreach>
                  <div class="form-group">
                    <label for="exampleInputPassword6">预约看房费用(费用为0是免费，费用为-1是无看房选项)<span style="color:red">*</span></label><br/>
					<input class="form-control" style="width: 60%;display:inline;" type="number" name="house_fee" required="required" value="{$fee.fee}">元
					</div>
				<div class="form-group">
					<label for="exampleInputPassword6">经纪人可以分得<span style="color:red">*</span></label><br/>
					<input class="form-control" style="width: 60%;display:inline;" type="number" name="house_ratio" required="required" value="{$fee.ratio}">%
					</div>
					<div class="form-group">
						<label for="exampleInputPassword6">经纪人ID<span style="color:red">*</span></label><br/>
						<input class="form-control" style="width: 60%;display:inline;" type="number" name="house_agent"  required="required" value="{$fee.agent}">
					</div>
                  <input type="hidden" name="hid" value="{$Think.get.hid}">
                  </div>

                   <div class="box-footer">
                    <button type="submit" class="btn btn-primary">提交房屋信息</button>
                  </div>
                </div><!-- /.box-body -->

                </form>

              </div><!-- /.box -->

      </section>

    </div>



  </div>
  <!-- 整个结束 -->


  <!-- jQuery 2.1.4 -->
  <script src="__PUBLIC__/Admin/plugins/jQuery/jQuery-2.1.4.min.js"></script>
  <!-- Bootstrap 3.3.5 -->
  <script src="__PUBLIC__/Admin/bootstrap/js/bootstrap.min.js"></script>
  <!-- DataTables -->
  <script src="__PUBLIC__/Admin/plugins/datatables/jquery.dataTables.min.js"></script>
  <script src="__PUBLIC__/Admin/plugins/datatables/dataTables.bootstrap.min.js"></script>
  <!-- SlimScroll -->
  <script src="__PUBLIC__/Admin/plugins/slimScroll/jquery.slimscroll.min.js"></script>
  <!-- FastClick -->
  <script src="__PUBLIC__/Admin/plugins/fastclick/fastclick.min.js"></script>
  <!-- AdminLTE App -->
  <script src="__PUBLIC__/Admin/dist/js/app.min.js"></script>
  <!-- AdminLTE for demo purposes -->
  <script src="__PUBLIC__/Admin/dist/js/demo.js"></script>


  <!-- 其他模板的js文件引入的部份開始 -->
  <script type="text/javascript" charset="utf-8" src="__PUBLIC__/ueditor/ueditor.config.js"></script>
  <script type="text/javascript" charset="utf-8" src="__PUBLIC__/ueditor/ueditor.all.min.js"> </script>
  <!--建议手动加在语言，避免在ie下有时因为加载语言失败导致编辑器加载失败-->
  <!--这里加载的语言文件会覆盖你在配置项目里添加的语言类型，比如你在配置项目里配置的是英文，这里加载的中文，那最后就是中文-->
  <script type="text/javascript" charset="utf-8" src="__PUBLIC__/ueditor/lang/zh-cn/zh-cn.js"></script>
  <!-- page script -->
  <script type="text/javascript">
      var ue = UE.getEditor('editor');
  </script>
  <script type="text/javascript" src="__PUBLIC__/Admin/area.js"></script>
  <!-- 编辑地址 -->
  <script type="text/javascript">
    var sheng = $('#s_province').attr('data');
    var shi = $('#s_city').attr('data');
    var qu = $('#s_county').attr('data');
    if (sheng && shi && qu) {
      var opt0 = [sheng,shi,qu];
    };
  </script>
  <script type="text/javascript">_init_area();</script>

  <script type="text/javascript">

  $(function(){
    $(document).on('click','.additem', function() {
        // 找到父级的div
        var parentTr = $(this).parents('.clone');
        // 克隆一个div
        var cl = parentTr.clone();
        parentTr.after(cl);
        cl.find('p').removeClass('additem').addClass('reitem').html('删除');
    });

     // 删除规格
    $(document).on('click','.reitem', function() {
      $(this).parents('.clone').remove();
    });

    //删除自动的
    $(document).on('click','.reitem_edit', function() {
      $(this).parents('.clone_edit').remove();
    });

    //如果有上传图片 下面的图片就自动取消
    $('.edit_img').change(function(event) {
      var i = $(this).index('.edit_img');
      $('.temp_img').eq(i).val();
      $('.img_pic').eq(i).css({display:'none'});
    });
  })
  </script>
  </body>
</html>
